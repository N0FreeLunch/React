## 로컬 환경과 서버 환경
- 로컬환경은 개인 컴퓨터에서 애플리케이션의 설정하는 것과 코드를 작성하는 것을 의미한다.
- 서버환경은 로컬에서 개발한 애플리케이션을 서버에서 실행하여 개발한 사람뿐만 아니라 다른 사람도 애플리케이션을 이용할 수 있게 하는 것이다.

#### 로컬 환경과 서버 환경의 다른점
- 로컬 환경은 개발자가 개발하기 좋은 환경을 만드는 것이며, 서버 환경은 고객들이 애플리케이션을 체험할 수 있도록 하기 때문에 로컬에서의 애플리케이션 설정과 서버에서의 애플리케이션 설정이 다른 점이 생길 수 있다.
- 도커를 사용하는 이유는 로컬과 서버에서 최대한 동일한 동작을 하도록 설정하는 것인데 

## ENV 파일 세팅하기
- 프로젝트 최상단 디렉토리에 `.env.local` 파일을 만든다.

#### git 추적에서 `.env`파일을 배제해야 하는 이유
- `.env`는 로컬과 서버에서 다르게 세팅할 값들을 저장하는 곳이다. 따라서 `github`등의 코드 저장소에 저장되지 않도록 설정해 주어야 한다. 동일한 코드 저장소에 `.env` 파일이 있다면 로컬과 서버에서 `.env`이 서로 공유되기 때문에 로컬과 서버에서 서로 다른 값을 지니는 설정을 할 수 없게 되어 버린다.
- 프로젝트 최상단 디렉토리의 `.gitignore` 파일에 `.env`를 추가하여 `git` 명령어에 의해 `.env` 파일이 추적되지 않도록 한다. `github` 등의 저장소에 `.env` 파일을 올리지 않기 위해서이다.
- `.gitignore`에서 git의 추적에서 배제된 대상은 저장소에 저장되지 않기 때문에 보안상의 민감한 값들을 `.env`에 적어준다. API 통신에 사용되는 키 값이나, 
- `.env` 파일은 보안상 관리되어야 할 값을 저장하고 있기 때문에 유출되지 않도록 각별히 신경써야 한다.
- 이미 git에 의해 추적되고 있는 파일은 `.gitignore`에 추가하여도 추적이 배제되지 않는다. 만약 추적이 되지 않도록 설정을 하더라도 기존의 기록이 남아 있기 때문에 이 파일을 지우기 위해서는 약간의 까다로운 과정을 거쳐야 한다.

#### NextJS에서 `.env`
- NestJS의 초기 설정 예제파일을 보면 `.gitignore` 파일이 포함되어 있고 다음 형식의 파일이 git의 추적에서 배제되어 있다.
```
# local env files
.env*.local
```
- 위의 기본 형태에 맞추어 로컬의 `.env` 파일을 `.env.local`으로 만들도록 하자.
- `.env*.local`에서 *는 `.env`와 `.local` 사이에 어떤 문자열이라도 와도 추적에서 배제할 `.env`로 하겠다는 의미이다.

#### `.env.example` 파일 만들기
- `.env` 파일을 세팅할 때는 `키=벨류` 형식으로 입력을 한다.
- 하지만 `.env` 파일은 git 저장소에 의해 공유가 되지 않으므로 어떤 키가 사용되는지 저장소의 코드를 이용하는 사람들은 알 수가 없다.
- `.env` 파일의 값은 애플리케이션의 코드에서도 사용하고 있기 때문에 애플리케이션에서 요구하는 키가 없으면 에러가 발생할 것이다.
- 이를 위해서 git에 의해 추적이 되는 `.env.example` 파일을 만든다. 이 파일은 추적이 되기 때문에 `키=` 형식으로 `.env` 파일과 동일한 키들을 적어서 관리하도록 한다.
- NextJS에서는 `.env*.local` 형식의 env 파일을 사용하기 때문에 example 파일도 `.env*.local.example` 형식으로 적어주는 것이 좋다. 따라서 동일한 키를 가지고 있는 `.env.local.example`파일을 만들도록 하자.

#### 로컬과 서버의 환경 변수 값 분리하기
- `.env` 파일에는 `APP_ENV=local`을 적어준다.
- 만약 서버라면 검증 서버와 프로덕션 서버가 있을 것이다. 검증서버의 env 파일에는 `APP_ENV=development` 프로덕션 서버의 env 파일에는 `APP_ENV=production`을 세팅하게 된다.

## 도커 컴포즈에서 `.env` 파일 사용하기
